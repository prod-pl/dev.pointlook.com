!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ReactDriveIn=e()}}(function(){return function e(t,i,s){function n(a,r){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};t[a][0].call(h.exports,function(e){var i=t[a][1][e];return n(i?i:e)},h,h.exports,e,t,i,s)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(e,t){t.exports=e("./lib")},{"./lib":2}],2:[function(e,t){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},s=function(){function e(e,t){for(var i in t){var s=t[i];s.configurable=!0,s.value&&(s.writable=!0)}Object.defineProperties(e,t)}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=i(e("jvent")),r=i(e("./timer")),l=i(e("./playlist")),u=i(e("./utils")),h=u.getWidth,p=u.getHeight,c=u.setStyles,d=u.findPoster,m=u.createEl,f=u.replaceChildren,y=function(e){function t(){o(this,t),this._listeners=[],this.parentEl=null,this.mediaEl=null,this.placeholderEl=null,this.mute=!0,this.currMediaType=null,this.mediaAspect=16/9,this.playlist=null,this.loop=!0,this.loopPlaylistItems=!1,this.slideshow=!1,this.playlistLength=0,this.currentItem=0,this.slideshowItemDuration=10,this._slideshowTimer=null,this._seeking=!1,this.poster=null,this.loading=!0}return n(t,e),s(t,{_updateSize:{value:function(e,t,i){var s=1,n=h(),o=p(),a=n/o;i>a?(c(this.parentEl,{width:Math.ceil(o*i)+"px",height:o+s+"px"}),"video"===t?c(e,{width:Math.ceil(o*i)+"px",height:o+"px"}):c(e,{width:"auto",height:o+s+"px"})):(c(this.parentEl,{width:n+"px",height:Math.ceil(n/i)+1+"px"}),"video"===t?c(e,{width:this.parentEl.offsetWidth+"px",height:"auto"}):c(e,{width:n+"px",height:"auto"}))}},_setVideoData:{value:function(){var e=this.mediaEl;this.mediaAspect=e.videoWidth/e.videoHeight,this._updateSize(e,"video",this.mediaAspect)}},_setImageData:{value:function(e){this.mediaAspect=e.naturalWidth/e.naturalHeight,this.isTouch||this._updateSize(this.mediaEl,"image",this.mediaAspect)}},_playVideoItem:{value:function(e,t){for(var i,s,n,o,a=this.mediaEl,r=[],l=e.length-1;l>=0;l--)i=e[l],0!==i.type.search(/^image/)||n?s=m("source",{src:i.src,type:i.type}):n=i.src,s&&(o=a.canPlayType(i.type),"probably"===o?r.unshift(s):r.push(s));r.length?(this.emit("media.loading"),a.preload="auto",(this.playlistLength<2||this.loopPlaylistItems)&&(a.loop=!0),this.mute&&this.setVolume(0),n&&(a.poster=n),f(a,r),this.currentItem=t,a.load()):n||this.poster?(this.slideshow=!0,this._createMediaEl(),this._playImageItem(e,t)):this.emit("media.error",new Error("No playable source"))}},_playImageItem:{value:function(e,t){var i,s;if(e&&e.length)for(var n in e)i=e[n],0!==i.type.search(/^image/)||s||(s=i.src);!s&&this.poster&&(s=this.poster.src),s?(this.emit("media.loading"),this.mediaEl.src=s,this.currentItem=t):this.emit("media.error",new Error("No playable source"))}},_setBackgroundItem:{value:function(){this.parentEl.style["background-image"]='url("'+this.poster.src+'")'}},_playItem:{value:function(e,t){return this.isTouch?(this._setBackgroundItem(),void this._playImageItem()):("video"===this.currMediaType&&this._playVideoItem(e,t),"image"===this.currMediaType&&this._playImageItem(e,t),void(this._seeking=!1))}},_loadPlaylist:{value:function(e){this.playlist=e,this.playlistLength=e.length,this._playItem(e[0],0)}},_addListener:{value:function(e,t,i){e.addEventListener(t,i),this._listeners.push({element:e,event:t,handler:i})}},_removeAllListeners:{value:function(){var e,t=this._listeners;for(var i in t)e=t[i],e.element.removeEventListener(e.event,e.handler)}},_attachVideoListeners:{value:function(){function e(e){a._setVideoData(e),a.emit("media.metadata",e)}function t(){a.emit("media.playing",a.currentItem)}function i(){a.emit("media.pause")}function s(e){var t=null,i=e.target;i.buffered&&i.buffered.length>0&&i.buffered.end&&i.duration?t=i.buffered.end(0)/i.duration:"undefined"!=typeof i.bytesTotal&&i.bytesTotal>0&&"undefined"!=typeof i.bufferedBytes&&(t=i.bufferedBytes/i.bytesTotal),null!==t&&(t=100*Math.min(1,Math.max(0,t))),1===i.networkState&&0===i.readyState&&(t=100),a.emit("media.progress",t)}function n(){a._seeking||a.emit("media.ended",a.currentItem)}function o(){a.emit("media.canplay"),r.play(),a._seeking&&(a._seeking=!1)}var a=this,r=this.mediaEl;this._addListener(r,"loadedmetadata",e),this._addListener(r,"playing",t),this._addListener(r,"pause",i),this._addListener(r,"ended",n),this._addListener(r,"canplay",o),this._addListener(r,"progress",s,!1)}},_attachImageListeners:{value:function(){function e(){var e=new Event("ended");n.mediaEl.dispatchEvent(e)}function t(){n.emit("media.pause")}function i(){n.emit("media.canplay"),n._setImageData(this),n.emit("media.metadata",this),n.emit("media.playing",n.currentItem),n.isTouch||n.playlistLength>1&&(n._slideshowTimer&&n._slideshowTimer.destroy(),n._slideshowTimer=new r(e,1e3*n.slideshowItemDuration),n._slideshowTimer.on("pause",t))}function s(){n.emit("media.ended",n.currentItem)}var n=this,o=this.mediaEl;this._addListener(o,"load",i),this._addListener(o,"ended",s)}},_attachListeners:{value:function(){function e(){window.requestAnimationFrame(function(){o.metadataLoaded&&o._updateSize(a,o.currMediaType,o.mediaAspect)})}function t(){if(!this._seeking){var e=0;return o.playlistLength>1&&o.loopPlaylistItems?void("image"===o.currMediaType&&o.play(o.currentItem)):void(o.playlistLength>1&&o.loop&&(o.currentItem+1<o.playlistLength&&(e=o.currentItem+1),o.play(e)))}}function i(){a.style.opacity=1,o.canplay=!0}function s(){o.metadataLoaded=!0}function n(){o.canplay=!1,o.metadataLoaded=!1}var o=this,a=this.mediaEl;return this.isTouch?void this._attachImageListeners():(this._addListener(window,"resize",e),"video"===this.currMediaType?this._attachVideoListeners():this._attachImageListeners(),this.on("media.ended",t),this.on("media.canplay",i),this.on("media.metadata",s),void this.on("media.loading",n))}},_setParent:{value:function(e){return this.isTouch?c(e,{width:"100%",height:"100%",display:"block","background-position":"50% 50%","background-repeat":"no-repeat no-repeat","background-attachment":"local","background-size":"cover"}):c(e,{position:"absolute",display:"block",transform:"translate3d(-50%,-50%,0)","-webkit-transform":"translate3d(-50%,-50%,0)",left:"50%",top:"50%"}),e}},_cleanup:{value:function(){for(var e=this.parentEl;e.firstChild;)e.removeChild(e.firstChild)}},_createMediaEl:{value:function(){var e;return this.mediaEl&&this._cleanup(),this.isTouch?(this.currMediaType="image",e=m("img"),c(e,{display:"none"}),e):(this.slideshow?(this.currMediaType="image",e=m("img")):(this.currMediaType="video",e=m("video",{height:1,width:1,preload:"metadata"})),e?(e.style.opacity=0,c(e,{display:"block"}),e):void 0)}},init:{value:function(e){e=e||{},this.isTouch=void 0!==e.isTouch?e.isTouch:"ontouchstart"in window,this.slideshow=e.slideshow,this.parentEl=this._setParent(e.el);var t=this._createMediaEl();this.parentEl.appendChild(t),this.mediaEl=t,this._attachListeners()}},show:{value:function(e,t){return e.constructor===Array?this.showPlaylist([e],t):e.constructor===Object?this.showPlaylist([[e]],t):this.showPlaylist([l.makePlaylistItem(e)],t)}},showPlaylist:{value:function(e,t){t=t||{},t.hasOwnProperty("mute")&&(this.mute=t.mute),t.hasOwnProperty("loop")&&(this.loop=t.loop),t.hasOwnProperty("loopPlaylistItems")&&(this.loopPlaylistItems=t.loopPlaylistItems,this.loopPlaylistItems&&(this.loop=!1));var i=l.makePlaylist(e);this.poster=t.poster?"string"==typeof t.poster?{src:t.poster}:t.poster:d(i),this._loadPlaylist(i)}},setVolume:{value:function(e){"image"!==this.currMediaType&&(0===e?(this.mute=!0,this.mediaEl.muted=!0,this.mediaEl.volume=0):(this.mute=!1,this.mediaEl.muted=!1,this.mediaEl.volume=e))}},setPlaybackRate:{value:function(e){"image"!==this.currMediaType&&(this.mediaEl.playbackRate=e||1)}},getMedia:{value:function(){return this.mediaEl}},getPlaylist:{value:function(){return this.playlist}},getItem:{value:function(e){return this.playlist[e]}},play:{value:function(e){this._seeking=!0,"number"==typeof e?this._playItem(this.playlist[e],e):"video"===this.currMediaType?this.mediaEl.play():this._slideshowTimer&&this._slideshowTimer.resume()}},pause:{value:function(){"video"===this.currMediaType?this.mediaEl.pause():this._slideshowTimer&&this._slideshowTimer.pause()}},close:{value:function(){this._removeAllListeners(),this._cleanup(),this._slideshowTimer&&(this._slideshowTimer.destroy(),delete this._slideshowTimer)}},currentTime:{value:function(){return"video"===this.currMediaType?this.mediaEl.currentTime:this._slideshowTimer.currentTime()}},seekTo:{value:function(e){this._seeking=!0,"video"===this.currMediaType&&(this.mediaEl.currentTime=e)}},duration:{value:function(){return"video"===this.currMediaType?this.mediaEl.duration:this.slideshowItemDuration}}}),t}(a);t.exports=y},{"./playlist":3,"./timer":4,"./utils":5,jvent:6}],3:[function(e,t){"use strict";function i(e){var t={},i={mp4:!0,ogv:!0,webm:!0},s={jpg:!0,png:!0,gif:!0},n=e.replace(/[\?|\#].+/,"").match(/\.([mp4|ogv|webm|jpg|jpeg|png|gif]+)$/)[1];return i[n]&&(t.type="ogv"===n?"video/ogg":"video/"+n),s[n]&&(t.type="jpg"===n?"image/jpeg":"image/"+n),t.src=e,t}function s(e,t){t=t||0;var n,o=[];for(var a in e)n=e[a],n.constructor===Object&&o.push([n]),n.constructor===Array&&o.push(s(n,t+1)),"string"==typeof n&&o.push(0===t?[i(n)]:i(n));return o}t.exports={makePlaylist:s,makePlaylistItem:i}},{}],4:[function(e,t){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},s=function(){function e(e,t){for(var i in t){var s=t[i];s.configurable=!0,s.value&&(s.writable=!0)}Object.defineProperties(e,t)}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=i(e("jvent")),r=function(e){function t(e,i){o(this,t),this.callback=e,this.remaining=i,this.timerId=null,this.start=null,this.resume()}return n(t,e),s(t,{pause:{value:function(e){clearTimeout(this.timerId),this.remaining-=new Date-this.start,e||this.emit("pause")}},resume:{value:function(e){this.start=new Date,clearTimeout(this.timerId),this.timerId=setTimeout(this.callback,this.remaining),e||this.emit("resume")}},currentTime:{value:function(){var e=new Date-this.start;return this.timerId&&(this.pause(!0),this.resume(!0)),e}},destroy:{value:function(){this.pause(!0),this.removeAllListeners()}}}),t}(a);t.exports=r},{jvent:6}],5:[function(e,t){"use strict";function i(){return self.innerHeight?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}function s(){return self.innerHeight?self.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:void 0}function n(e,t){var i="";for(var s in t)i+=s+":"+t[s]+";";e.style.cssText+=";"+i}function o(e){var t,i;for(var s in e){if(i=e[s],i.constructor===Array)t=o(i);else if(i.type.search(/^image/)>-1)return i;if(t)return t}}function a(e,t){[].slice.call(e).forEach(t)}function r(e,t){var i=e.children||e.childNodes;i.length&&a(i,function(i){var s=t.shift();s?e.replaceChild(s,i):e.removeChild(i)}),t.length&&t.forEach(function(t){e.appendChild(t)})}function l(e,t){var i=document.createElement(e);for(var s in t)i[s]=t[s];return i}t.exports={getWidth:i,getHeight:s,setStyles:n,findPoster:o,eachNode:a,replaceChildren:r,createEl:l}},{}],6:[function(e,t){"use strict";function i(){}i.prototype.on=function(e,t){return this._collection=this._collection||{},this._collection[e]=this._collection[e]||[],this._collection[e].push(t),this},i.prototype.once=function(e,t){function i(){s.off(e,i),t.apply(this,arguments)}var s=this;return i.listener=t,this.on(e,i),this},i.prototype.off=function(e,t){var i=this._collection[e],s=0;if(void 0!==i)for(s;s<i.length;s+=1)if(i[s]===t||i[s].listener===t){i.splice(s,1);break}return 0===i.length&&this.removeAllListeners(e),this},i.prototype.removeAllListeners=function(e){return this._collection=this._collection||{},delete this._collection[e],this},i.prototype.listeners=function(e){return this._collection=this._collection||{},this._collection[e]},i.prototype.emit=function(){if(void 0===this._collection)return this;var e,t=[].slice.call(arguments,0),i=t.shift(),s=this._collection[i],n=0;if(s)for(s=s.slice(0),e=s.length,n;e>n;n+=1)s[n].apply(this,t);return this},t.exports=i},{}],7:[function(e,t,i){(function(s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}i.__esModule=!0;var r="undefined"!=typeof window?window.React:"undefined"!=typeof s?s.React:null,l=n(r),u=e("drive-in"),h=n(u),p=function(e){function t(i){o(this,t),e.call(this,i),this.state={className:i.className,mute:i.mute,loop:i.loop,loopPaylistItems:i.loopPlaylistItems,slideshow:i.slideshow,volume:i.volume,onTimeFrequency:i.onTimeFrequency},this.setPlaying=this.setPlaying.bind(this),this.setPause=this.setPause.bind(this),this.setLoading=this.setLoading.bind(this),this.setCanPlay=this.setCanPlay.bind(this)}return a(t,e),t.prototype.getMedia=function(){return this.refs.media.getDOMNode()},t.prototype.getPlaylist=function(){return this.state.playlist},t.prototype.setPlaying=function(e){this.setState({playing:!0,currentItem:e}),this.props.onPlaying&&this.props.onPlaying(e)},t.prototype.setPause=function(){this.setState({playing:!1}),this.props.onPause&&this.props.onPause()},t.prototype.setLoading=function(){this.setState({canPlay:!1})},t.prototype.setCanPlay=function(){this.setState({canPlay:!0}),this.props.onCanPlay&&this.props.onCanPlay()},t.prototype.componentWillMount=function(){this.DI=new h["default"],this.DI.on("media.playing",this.setPlaying),this.DI.on("media.pause",this.setPause),this.DI.on("media.loading",this.setLoading),this.DI.on("media.canplay",this.setCanPlay)},t.prototype.componentDidMount=function(){var e=this,t=void 0;this.DI.init({el:this.getMedia(),slideshow:this.props.slideshow});var i={mute:this.props.mute,loop:this.props.loop,loopPlaylistItems:this.props.loopPlaylistItems,poster:this.props.poster,isTouch:this.props.isTouch};t=this.props.showPlaylist?this.DI.showPlaylist(this.props.showPlaylist,i):this.DI.show(this.props.show,i),this.props.onTime&&(this.intervalId=window.setInterval(function(){e.props.onTime(e.DI.currentTime())},this.props.onTimeFrequency)),this.props.playbackRate&&this.playbackRate(this.props.playbackRate),this.setState({initalized:!0,playlist:t})},t.prototype.componentWillUnmount=function(){this.intervalId&&window.clearInterval(this.intervalId),this.DI.removeAllListeners(),this.DI.close(),delete this.DI},t.prototype.play=function(e){this.DI.play(e)},t.prototype.pause=function(){this.DI.pause()},t.prototype.mute=function(){this.DI.setVolume(0),this.setState({mute:!0})},t.prototype.unmute=function(){this.DI.setVolume(this.props.volume),this.setState({mute:!1})},t.prototype.playbackRate=function(e){e=e||1,this.DI.setPlaybackRate(e),this.setState({playbackRate:e})},t.prototype.seekTo=function(e){this.DI.seekTo(e)},t.prototype.duration=function(){return this.DI.duration()},t.prototype.render=function(){return l["default"].createElement("div",{ref:"wrap",className:this.props.className+" drive-in-wrap"},l["default"].createElement("div",{ref:"media",className:"drive-in-media"}))},t}(l["default"].Component);p.displayName="DriveIn",p.propTypes={show:l["default"].PropTypes.oneOfType([l["default"].PropTypes.string,l["default"].PropTypes.array]),showPlaylist:l["default"].PropTypes.oneOfType([l["default"].PropTypes.array]),poster:l["default"].PropTypes.string,mute:l["default"].PropTypes.bool,loop:l["default"].PropTypes.bool,loopPlaylistItems:l["default"].PropTypes.bool,playbackRate:l["default"].PropTypes.number,slideshow:l["default"].PropTypes.bool,onPlaying:l["default"].PropTypes.func,onPause:l["default"].PropTypes.func,onTime:l["default"].PropTypes.func,onTimeFrequency:l["default"].PropTypes.number,onCanPlay:l["default"].PropTypes.func,isTouch:l["default"].PropTypes.func,volume:l["default"].PropTypes.number,className:l["default"].PropTypes.string},p.defaultProps={className:"drive-in",mute:!0,loop:!0,loopPaylistItems:!1,slideshow:!1,volume:.5,onTimeFrequency:500},i["default"]=p,t.exports=i["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"drive-in":1}]},{},[7])(7)});